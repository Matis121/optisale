<%= form_with(model: @user, url: manage_users_path, method: :post, id: "user-form", class: "space-y-6") do |form| %>
  <% if @user.errors.any? %>
    <div class="alert alert-error">
      <div>
        <i class="fas fa-exclamation-circle"></i>
        <div>
          <h3 class="font-bold">Wystąpiły następujące błędy:</h3>
          <ul class="list-disc list-inside mt-2">
            <% @user.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  <% end %>
  <div class="form-control w-full">
    <%= form.label :email, "Email", class: "label" %>
    <%= form.email_field :email, class: "input input-bordered w-full", placeholder: "user@example.com" %>
  </div>
  <div class="form-control w-full">
    <%= form.label :role, "Rola", class: "label" %>
    <%= form.select :role, 
        [['Pracownik', 'employee']], 
        {}, 
        class: "select select-bordered w-full",
        data: { action: "change->user-form#toggleAccountFields" } %>
    <label class="label">
      <span class="label-text-alt text-base-content/60">Właściciel tworzy nowe konto, pracownik jest przypisany do istniejącego</span>
    </label>
  </div>
  <div class="form-control w-full">
    <%= form.label :password, @user.persisted? ? "Nowe hasło (zostaw puste, aby nie zmieniać)" : "Hasło", class: "label" %>
    <%= form.password_field :password, class: "input input-bordered w-full", autocomplete: "new-password" %>
    <label class="label">
      <span class="label-text-alt text-base-content/60">Minimum 12 znaków</span>
    </label>
  </div>
  <div class="form-control w-full">
    <%= form.label :password_confirmation, "Potwierdzenie hasła", class: "label" %>
    <%= form.password_field :password_confirmation, class: "input input-bordered w-full", autocomplete: "new-password" %>
  </div>
  <div class="flex gap-3 justify-end mt-10 pt-6 border-t border-gray-500/30">
    <% if @user.new_record? %>
      <%= form.submit "Utwórz użytkownika", class: "btn btn-primary" %>
    <% else %>
      <%= form.submit "Zapisz zmiany", class: "btn btn-primary" %>
    <% end %>
    <button type="button" class="btn btn-ghost" onclick="modal.close()">Zamknij</button>
  </div>
<% end %>
